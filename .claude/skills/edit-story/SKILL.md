---
name: edit-story
description: story/ の資料を自然言語指示で編集する。波及影響を分析し関連ファイルの更新も提案する。
---

# /edit-story — 資料編集スキル

## 概要

ユーザーの自然言語指示に基づき、`story/` の資料ファイルを更新する。変更による波及影響を分析し、関連ファイルの整合性も維持する。

## 引数

- `$ARGUMENTS` — 自然言語の変更指示

**使用例:**
```
/edit-story 主人公の年齢を20歳にして、社会人の設定にしたい
/edit-story 第10話あたりにどんでん返しを入れたい
/edit-story ダッシュの使用を完全禁止にして
/edit-story 読者ペルソナの1人目をもっと辛口にしたい
```

## 実行手順

### 1. 指示の解析

ユーザーの指示から以下を特定する:
- **対象ファイル**: どの `story/*.md` ファイルが変更対象か
- **変更内容**: 何をどう変えるか
- **変更の規模**: 小（1ファイル内の局所変更）/ 中（複数ファイルに影響）/ 大（全体構成に影響）

### 2. 対象ファイルの読み込み

変更対象のファイルと、波及影響の分析に必要な関連ファイルを読み込む。

| 変更対象 | 関連チェック対象 |
|---------|----------------|
| `premise.md` | 全ファイル（基本設定の変更は全体に影響） |
| `setting.md` | `characters.md`, `plot-outline.md` |
| `characters.md` | `plot-outline.md`, `reader-personas.md` |
| `plot-outline.md` | `premise.md`（話数変更の場合） |
| `writing-guide.md` | なし（独立して変更可能） |
| `reader-personas.md` | なし（独立して変更可能） |

### 3. 波及影響の分析

変更が他のファイルに影響を与えるか分析し、ユーザーに報告する:

```
📝 変更対象: characters.md
   変更内容: 主人公の年齢を17歳→20歳に変更

⚠️ 波及影響:
1. setting.md — 学園設定 → 職場設定への変更が必要
2. plot-outline.md — 高校イベント（文化祭等）の見直しが必要
3. characters.md — 他キャラとの関係性（同級生→同僚等）の調整が必要

上記の変更を一括で行いますか？
```

### 4. ユーザー承認

波及影響を含めた変更案を提示し、ユーザーの承認を得る。承認パターン:
- **全承認**: 提案通りに全て変更
- **部分承認**: 一部のみ変更（ユーザーが選択）
- **却下**: 変更しない
- **修正**: 変更内容を調整して再提案

### 5. 変更の実行

承認された変更を対象ファイルに反映する。

### 6. 変更レポート

変更完了後、以下を報告する:
- 変更されたファイル一覧
- 各ファイルの変更箇所の概要
- 「変更が反映されました。/write-episode で次のエピソードを執筆できます。」

## 特殊ケース

### episode-summaries.md / handover-notes.md の編集

執筆済みの記録に関する変更は通常推奨しない。ユーザーが明示的に指示した場合のみ実行し、以下の警告を表示する:

```
⚠️ episode-summaries.md は執筆済みエピソードの記録です。
変更すると、以降のエピソードとの整合性に影響する可能性があります。
本当に変更しますか？
```

### quality-log.md の編集

品質ログは自動記録であるため、編集を受け付けない。ユーザーに説明する。
