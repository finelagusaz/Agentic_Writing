---
name: setup-world
description: 新しい作品の世界・キャラクター・文体を対話的に構築する。ジャンル・設定・登場人物・プロット骨格・文体を7ステップで定義し、story/ に全資料を出力する。
---

# /setup-world — 世界設定スキル

## 概要

対話フローで新しい作品の全設定を構築する。各ステップでリコメンドを提示し、ユーザーが「OK」なら即採用、修正があれば反映して次へ進む。

## 前提条件

- `story/` ディレクトリが空であること（既存データがある場合はユーザーに確認）

## 実行手順

以下の7ステップを**順次**実行する。各ステップの流れ:
1. 前ステップの決定を踏まえた**リコメンドを提示**
2. ユーザーが「OK」→ 採用して次へ / 修正指示 → 再提案 / 自由入力 → 反映
3. **必ずユーザーの承認を得てから次のステップに進む**

***

### Step 1: カテゴリ → ジャンル選択

ユーザーに大分類を提示する:

```
どのカテゴリの作品を書きますか？

📚 A. ライトノベル・Web小説
   エンタメ重視。テンポ・キャラ立ち・読みやすさが優先。

📖 B. 小説
   文芸寄り。描写力・構成・テーマの深みが優先。
```

選択後、カテゴリに応じたジャンル一覧を提示する:

**A. ライトノベル・Web小説の場合:**
```
⚔️ 異世界・ファンタジー
  ├── 異世界転生（なろう系）
  ├── 異世界転移
  ├── ハイファンタジー（非転生）
  ├── ローファンタジー
  └── ダークファンタジー

💕 恋愛・ラブコメ
  ├── 学園ラブコメ
  ├── 異世界恋愛
  ├── BL / 百合
  └── 社会人恋愛

🎮 その他エンタメ
  ├── バトル・能力もの
  ├── 日常系・スローライフ
  ├── お仕事もの
  ├── ホラー
  └── SF・近未来

📝 フリー入力
```

**B. 小説の場合:**
```
🔍 ミステリー・推理
  ├── 本格ミステリー
  ├── 社会派ミステリー
  └── 日常の謎

📖 文芸・ヒューマンドラマ
  ├── 現代文芸
  ├── 青春小説
  └── 家族小説

🏯 歴史・時代小説
🌌 SF
😱 ホラー・怪奇
📝 フリー入力
```

ジャンル選択後、そのジャンルで人気の「お約束」パターンを3〜5個リコメンドする。

**リコメンド例**（異世界転生を選んだ場合）:
```
💡 異世界転生で人気の構成パターン:
1. チート無双型 — 圧倒的な力で成り上がる爽快感
2. スローライフ型 — 能力はあるがのんびり暮らす
3. 成長型 — 弱い状態から努力・工夫で強くなる
4. 復讐・やり直し型 — 不遇からの逆転
5. 領地経営型 — 内政・街づくり

どれに近いですか？ または自由にどうぞ。
```

内部変数として `category`（LN/Web or 小説）と `genre`、`pattern` を記録する。

***

### Step 2: テーマ・コンセプト

ジャンル＋パターンから **3〜5個のテーマ案** と **ログライン案** をリコメンドする。

リコメンドには以下を含む:
- テーマの核心（一言で表現）
- テーマがなぜこのジャンルと相性がいいか（一文）
- ログライン案（1〜2文の作品要約）

ユーザーの選択・修正を反映し、以下を確定する:
- **テーマ**（一言）
- **ログライン**（1〜2文）
- **トーン**（シリアス度合い、ユーモアの割合）
- **想定話数**と**1話あたりの文字数目安**

***

### Step 3: 世界観・設定

ジャンルに応じた**重点設定項目**でフレームワークを提案する。

| ジャンル系統 | 重点設定項目 |
|------------|------------|
| 異世界系 | 魔法体系、種族、国家、ギルド制度、レベル/スキルシステム |
| 恋愛系 | 学校/職場の構造、人間関係図、季節行事 |
| ミステリー | 舞台の地理、閉鎖空間の構造、手がかかりの配置ルール |
| SF | テクノロジーレベル、社会制度、科学的根拠の範囲 |
| 歴史 | 時代背景、身分制度、文化・風俗 |

**差別化ポイント**（この作品ならではの独自要素）を3案提示し、ユーザーに選択・調整してもらう。

***

### Step 4: キャラクター

カテゴリによってアプローチを分ける:

**LN/Web小説の場合:**
- アーキタイプベースで提案 → 個性を肉付け
- 主人公タイプ: 巻き込まれ型 / 目的駆動型 / 探求者型
- パーティ構成: ジャンルに合ったアーキタイプの組み合わせを提案

**小説の場合:**
- テーマとの関係性ベースで提案 → 内面の複雑さを設計
- キャラ同士の緊張関係、秘密、価値観の対立を重視

**各キャラについて以下を定義する:**
- 名前（和名 or カタカナ名をジャンルに応じて）
- 年齢・外見
- 性格
- **口調テンプレート**（「〜だぜ」系 / 「〜ですわ」系 etc. + **具体的な例文3つ以上**）
- 能力・役割
- 秘密・成長の方向性
- 他キャラとの関係性

主要キャラ3〜5人を提案し、ユーザーの修正を反映する。

***

### Step 5: プロット骨格

ジャンル別の典型プロット構造テンプレートをリコメンドする。

**テンプレート例:**
| ジャンル | 典型構造 |
|---------|---------|
| 異世界転生 | 転生→適応→仲間集め→試練→中ボス→真相→最終決戦 |
| ラブコメ | 出会い→距離感→イベント→すれ違い→告白→結末 |
| ミステリー | 事件発生→捜査→偽の手がかり→真犯人の影→対決→解決 |
| バトルもの | 敗北→修行→勝利→強敵→覚醒→最終戦 |

Step 2 で決めた想定話数に合わせて:
- **三幕構成**（序盤/中盤/終盤）の幕割り
- **各話の概要**（1〜2行ずつ）
- **ターニングポイント**の位置
- **主要な伏線**の張りどころと回収予定（各伏線について「張る話」「回収する話」を明記。回収予定話は想定話数を超えないこと）

をリコメンドし、ユーザーの修正を反映する。

***

### Step 6: 文体ガイド + AI癖制御

Step 1 の大分類に応じたデフォルトをベースに提案する。

**LN/Web小説のデフォルト:**
| 項目 | デフォルト |
|------|----------|
| 視点 | 一人称 or 三人称一元 |
| 文長 | 一文30〜40字、短文テンポ重視 |
| 会話比率 | 高め（50〜60%） |
| トーン | 軽快、キャラの個性で引っ張る |
| 1話文字数 | 2,000〜4,000字 |

**小説のデフォルト:**
| 項目 | デフォルト |
|------|----------|
| 視点 | 三人称 or 一人称（作品次第） |
| 文長 | 40〜60字、描写は長文も許容 |
| 会話比率 | 控えめ（30〜40%） |
| トーン | テーマに従う。情景・心理描写重視 |
| 1話文字数 | 3,000〜6,000字 |

デフォルトを提示した上で、ユーザーに調整を促す。

#### AI癖制御

以下の2層構造で設定する:

**コア制御（デフォルトON — これらは常に有効）:**

| # | 制御項目 | ルール | 適用対象 |
|---|---------|-------|---------|
| 1a | **感情直接描写禁止** | 感情・状態を「〜と思った」「〜な気持ちだった」等で直接説明しない。身体反応・行動で示す | 地の文のみ |
| 1b | **メタ匂わせ禁止** | 「何かが変わろうとしていた」等の要約的予告や作者的な語りを入れない | 地の文のみ |
| 1c | **要約的語り制限** | 「〜な日々が続いた」等のシーン省略まとめは最小限。具体的場面で示す | 地の文のみ |
| 1d | **説明セリフ禁止** | キャラが読者向けに設定・状況を説明するセリフを書かない | セリフのみ |
| 2 | **文末バリエーション** | 同じ文末は連続2回まで。3回目は別パターン | 地の文のみ |
| 3 | **独自用語の創作禁止** | setting.md / characters.md にない固有名詞を使わない | 共通 |
| 4 | **セリフの口調一貫性** | `characters.md` の口調テンプレートを最優先とする。writing-guide の文体ルールはセリフに対して**口調テンプレートに反する場合は適用しない** | セリフのみ |

**オプション制御（ユーザーが選択）:**

以下の各項目について選択肢を提示し、ユーザーに選んでもらう:

| # | 制御項目 | 選択肢 | 適用対象 |
|---|---------|-------|---------|
| 1 | ダッシュ（——）の使用 | 禁止 / 1話2回まで / 1話5回まで / 制限なし | 共通（地の文・セリフ別カウント） |
| 2 | 比喩・形容の量（直喩含む） | 1シーン1回 / 1シーン2回 / 制限なし | 地の文のみ |
| 3 | 体言止めの連続 | 2連続まで / 3連続まで / 制限なし | 地の文のみ |
| 4 | 修飾語の重ね | 厳しく制限 / 軽く注意 / 制限なし | 地の文のみ |
| 5 | 接続詞の多様性 | 同一接続詞の連続禁止 / 軽く注意 / 制限なし | 地の文のみ |

各項目にカテゴリ・ジャンルに基づいた**推奨値**を付けてリコメンドする。

#### writing-guide.md の必須セクション構成

生成される `story/writing-guide.md` には以下のセクションを必ず含めること:

1. **基本文体** — 視点、トーン、文長、段落の長さ（文末バリエーションは「地の文のルール」セクションに移動）
2. **地の文のルール** — 地の文にのみ適用されるAI癖制御を集約:
   - 文末バリエーション（同じ文末は連続2回まで）
   - 感情直接描写禁止（身体反応・行動で示す）
   - メタ匂わせ禁止（要約的予告・作者的な語りを入れない）
   - 要約的語り制限（具体的場面で示す）
   - 比喩・形容の量（オプション制御で設定した上限）
   - 体言止め連続制限（オプション制御で設定した値）
   - 修飾語の重ね制限（オプション制御で設定した値）
   - 接続詞の多様性（オプション制御で設定した値）
3. **セリフのルール** — セリフにのみ適用されるルールを集約:
   - `characters.md` の口調テンプレートが **最優先**。writing-guide の数量制限（文末バリエーション、比喩量等）はセリフには適用しない
   - 説明セリフ禁止（読者向けに設定・状況を説明するセリフを書かない）
   - ダッシュ上限はセリフ単独でもカウントする（地の文と分離）
4. **「見せる」原則（Show, Don't Tell）** — 以下の4カテゴリそれぞれに○/×の具体例を付けて記述:
   - 感情を見せる（身体反応・行動・五感で示す）【地の文】
   - 世界観・設定を見せる（キャラの行動・会話の中で伝える）【地の文・共通】
   - 能力・強さを見せる（具体的描写で実感させる）【共通】
   - 関係性を見せる（やり取りや行動で浮かび上がらせる）【共通】
5. **記法ルール** — 改行・空行、会話文、心内語、シーン転換、固有名詞初出ルール
6. **描写ガイドライン** — 以下を含む（すべて地の文対象）:
   - 五感描写（毎シーン最低2感覚）
   - 冒頭の吸引力（五感・感情で始める。状況説明から入らない）
   - テンポ制御（静→動→静の波、加速・減速の手法）
   - 感情描写（身体反応・仕草の細部で表現）
   - 主人公の能動性（各話に最低1箇所、自分の判断で局面を動かす）
   - 反復・対句（意図的な反復 vs 無意識な重複）
   - 伏線の埋め方（描写に自然に埋め込む、1話に新規伏線1〜2本）
7. **エピソード構成テンプレート** — 基本型に加え、以下のバリエーションを記載:
   - 冒頭クライマックス型 / 日常崩壊型 / 静謐一貫型 / 謎解き型 / 時間跳躍型 / 会話劇型
   - 構成の自己診断（直前2話と同じパターンを避ける）
8. **禁止事項** — メタナラティブ参照、現代語混入（ジャンル次第）、ご都合展開等
9. **表記の正式名称** — setting.md / characters.md を正とする旨

***

### Step 7: 読者ペルソナ

ジャンル・ターゲット読者層に合った**3ペルソナ**を自動生成してリコメンドする。

各ペルソナに以下を定義:
- **名前**（日本語名）
- **年齢・性別**
- **読書歴・好きな作品傾向**
- **重視するポイント**（3〜5個）
- **口調・トーン**（フィードバック時の語り口 + 例文）
- **評価基準**（★5→★1 の基準）
- **ペルソナ3は設定整合性チェック担当** — 他の2名より分析的な視点を持つ

リコメンドを提示し、ユーザーの修正を反映する。

***

## 出力

全7ステップ完了後、以下のファイルを `story/` に一括出力する:

### コンテンツファイル（ステップの成果物）

| ファイル | 内容 | 生成元 |
|---------|------|-------|
| `story/premise.md` | 作品コンセプト（ジャンル、テーマ、ログライン、トーン、想定話数、文字数目安） | Step 1-2 |
| `story/setting.md` | 世界観・設定 | Step 3 |
| `story/characters.md` | 登場人物（全キャラの詳細 + 口調テンプレート） | Step 4 |
| `story/plot-outline.md` | プロット骨格（三幕構成 + 各話概要） | Step 5 |
| `story/writing-guide.md` | 文体ガイド + AI癖制御ルール（コア制御 + オプション制御） | Step 6 |
| `story/reader-personas.md` | 読者ペルソナ定義（3名分） | Step 7 |

### テンプレートファイル（初期構造のみ）

| ファイル | 初期内容 |
|---------|---------|
| `story/episode-summaries.md` | ヘッダー + 「アーク要約」「直近エピソード詳細」の空セクション |
| `story/handover-notes.md` | ヘッダー + 各セクション（設定整合性/未回収伏線/表現・演出/キャラクター描写/読者からの要望/継続的な指針）の空テンプレート |
| `story/quality-log.md` | ヘッダー + テーブルヘッダーのみ |
| `story/series-tracker.md` | 横断追跡テンプレート（アクション配分/登場密度/伏線進展/表現パターン） |

### `story/series-tracker.md` の初期テンプレート

以下の内容で出力すること:

```markdown
# Series Tracker

<!-- 編集エージェントが方針策定時に冒頭で参照する横断追跡データ -->
<!-- エピソード確定時（Step 7）にリーダーが更新する -->

## アクション配分（直近3話）

| 話数 | 区分 | バトル有無 | 備考 |
|------|------|----------|------|
| N-2 | 未記入 | 未記入 | 初期化時に埋める |
| N-1 | 未記入 | 未記入 | 初期化時に埋める |
| N | 未記入 | 未記入 | 初期化時に埋める |

→ 次話の制約: なし（初期化直後）

## キャラクター登場密度（直近5話）

| キャラ | EpN-4 | EpN-3 | EpN-2 | EpN-1 | EpN | 薄い回連続 |
|--------|------|------|------|------|------|-----------|
| 主人公 | 未記入 | 未記入 | 未記入 | 未記入 | 未記入 | 0 |

凡例: ◎重要 ○台詞あり △存在感のみ ×不在 —未登場
警告: △以下が2話連続 → 次話で○以上を方針に組み込む

現在の警告: なし

## 伏線・要素の進展追跡

| 要素 | 最終進展話 | 最終進展の具体的内容 | 未進展話数 |
|------|-----------|-------------------|-----------|
| 主要未回収伏線A | 未記入 | 未記入 | 0 |
| 主要未回収伏線B | 未記入 | 未記入 | 0 |

警告: 未進展2話以上 → 次話で「前回と異なる形式」の微小進展を必須化
※「言及」≠「進展」。同じ状態の繰り返しは進展に数えない。

現在の警告: なし

## 表現パターン累積（直近5話）

| パターン | EpN-4 | EpN-3 | EpN-2 | EpN-1 | EpN | 5話合計 | 1話上限 | 状態 |
|---------|------|------|------|------|------|--------|--------|------|
| 身体部位比喩（抽象） | 0 | 0 | 0 | 0 | 0 | 0 | — | 正常 |
| ダッシュ（——） | 0 | 0 | 0 | 0 | 0 | 0 | 5 | 正常 |

注意: 物理位置の説明（例: 胸元の装備）は比喩カウントに含めない
状態更新基準:
- `1話上限` が数値の行: 今話回数が上限を超えたら `要分散`、それ以外は `正常`
- `1話上限` が `—` の行: 5話合計が10以上なら `要分散`、それ以外は `正常`
```

### 出力後の確認

全ファイル出力後、ユーザーに以下を報告する:
- 生成されたファイル一覧
- 各ファイルの概要（1行ずつ）
- `/edit-story` で後から修正可能であること
- `/write-episode 1` で執筆を開始できること
